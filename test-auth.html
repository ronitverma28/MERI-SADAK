<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication Test - MERI SADAK</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <i class="fas fa-road text-primary me-2"></i>
                MERI SADAK
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="complaint.html">Complaint</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="records.html">Records</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contact.html">Contact Us</a>
                    </li>
                </ul>
                
                 <div class="d-flex login-signup-buttons">
            <a href="login.html" class="btn btn-outline-primary me-2">Login</a>
            <a href="signup.html" class="btn btn-primary">Sign Up</a>
          </div>
            </div>
        </div>
    </nav>

    <!-- Test Section -->
    <section class="py-5" style="margin-top: 76px;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h3 class="mb-0"><i class="fas fa-shield-alt me-2"></i>Authentication Test Page</h3>
                        </div>
                        <div class="card-body">
                            <div id="authStatus" class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                Checking authentication status...
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <h5>Test Different Roles:</h5>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-outline-primary" onclick="testLogin('user')">
                                            <i class="fas fa-user me-2"></i>Login as Regular User
                                        </button>
                                        <button class="btn btn-outline-warning" onclick="testLogin('state-government')">
                                            <i class="fas fa-building me-2"></i>Login as State Government
                                        </button>
                                        <button class="btn btn-outline-success" onclick="testLogin('central-government')">
                                            <i class="fas fa-landmark me-2"></i>Login as Central Government
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <h5>Test Access Control:</h5>
                                    <div class="d-grid gap-2">
                                        <a href="records.html" class="btn btn-outline-secondary" id="testRecordsBtn">
                                            <i class="fas fa-database me-2"></i>Test Records Access
                                        </a>
                                        <button class="btn btn-outline-danger" onclick="logoutUser()">
                                            <i class="fas fa-sign-out-alt me-2"></i>Logout
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <div class="row">
                                <div class="col-12">
                                    <h5>Current Session Information:</h5>
                                    <div id="sessionInfo" class="bg-light p-3 rounded">
                                        <p class="mb-1"><strong>User:</strong> <span id="currentUser">Not logged in</span></p>
                                        <p class="mb-1"><strong>Role:</strong> <span id="currentRole">None</span></p>
                                        <p class="mb-1"><strong>State:</strong> <span id="currentState">N/A</span></p>
                                        <p class="mb-0"><strong>Records Access:</strong> <span id="recordsAccess">No</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="assets/js/main.js"></script>
    <script src="assets/js/auth.js"></script>
    
    <script>
        function testLogin(role) {
            const testCredentials = {
                'user': { email: 'user@rms.com', password: 'user123' },
                'state-government': { email: 'state@rms.com', password: 'state123' },
                'central-government': { email: 'central@rms.com', password: 'central123' }
            };
            
            const credentials = testCredentials[role];
            loginUser(credentials.email, credentials.password);
            updateStatus();
        }
        
        function updateStatus() {
            const authStatus = document.getElementById('authStatus');
            const currentUser = document.getElementById('currentUser');
            const currentRole = document.getElementById('currentRole');
            const currentState = document.getElementById('currentState');
            const recordsAccess = document.getElementById('recordsAccess');
            const testRecordsBtn = document.getElementById('testRecordsBtn');
            
            if (isAuthenticated()) {
                const user = getCurrentUser();
                const role = getCurrentRole();
                const state = getUserState();
                
                authStatus.className = 'alert alert-success';
                authStatus.innerHTML = '<i class="fas fa-check-circle me-2"></i>You are logged in!';
                
                currentUser.textContent = user.name || user.email;
                currentRole.textContent = role.replace('-', ' ').toUpperCase();
                currentState.textContent = state || 'N/A';
                recordsAccess.textContent = hasRecordsAccess() ? 'Yes' : 'No';
                
                testRecordsBtn.className = hasRecordsAccess() ? 'btn btn-success' : 'btn btn-outline-secondary';
            } else {
                authStatus.className = 'alert alert-warning';
                authStatus.innerHTML = '<i class="fas fa-exclamation-triangle me-2"></i>You are not logged in.';
                
                currentUser.textContent = 'Not logged in';
                currentRole.textContent = 'None';
                currentState.textContent = 'N/A';
                recordsAccess.textContent = 'No';
                
                testRecordsBtn.className = 'btn btn-outline-secondary';
            }
        }
        
        // Update status on page load and when authentication changes
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus();
            updateNavigationForAuth();
        });
        
        // Listen for authentication changes
        window.addEventListener('storage', function(e) {
            if (e.key === 'meriSadakUser' || e.key === 'meriSadakRole') {
                updateStatus();
                updateNavigationForAuth();
            }
        });
    </script>
</body>
</html>
